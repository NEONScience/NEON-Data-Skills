---
syncID:
title: "NEON MDP Data - Download and Explore"
description: 
dateCreated: 2025-08-20
authors: Cove Sturtevant, Claire Lunch, David Durden, Chris Florian
contributors: 
estimatedTime: 
packagesLibraries: 
topics: 
languagesTool: 
dataProduct: 
code1: 
tutorialSeries: 
urlTitle: 
---

This tutorial provides an introduction to working with NEON Mobile Deployment 
Platform (MDP) data, using the `neonMDP` and `neonUtilities` R packages. If you are new to NEON data, we also recommend more general tutorials, such as the 
<a href="https://www.neonscience.org/neonDataStackR" target="_blank">neonUtilities tutorial</a>
or the <a href="https://www.neonscience.org/download-explore-neon-data" target="_blank">Download and Explore tutorial</a>. 

A key difference between public NEON data and MDP data is that MDP data are
not retrieved from the NEON Data Portal. Rather, data are accessed directly from 
a Google Cloud Storage bucket with a more complex directory structure than data
packages downloaded from the Portal. This tutorial will show a user how to 
download the data from the bucket to a local data store and load it into the R 
computing environment for exploration, providing entry points to other NEON 
tutorials which initially rely on data retrieval from the Portal. This tutorial
will end with instructions to write the data loaded into the R environment to 
.csv format should the user desire to work with the data in another application 
in a more traditional format.

<div id="ds-objectives" markdown="1">

## Learning Objectives 
After completing this tutorial you will be able to: 

* Download, compile, and export MDP data 

## Things You’ll Need To Complete This Tutorial

### R Programming Language
You will need a current version of R to complete this tutorial. We also recommend 
the RStudio IDE to work with R. 

### R Packages to Install
Prior to starting the tutorial ensure that the following packages are installed.

* **neonMDP:** `devtools::install_github('NEONScience/NEON-mobile-deployment/neonMDP')`
* **neonUtilities:** `install.packages("neonUtilities")`
* **googleCloudStorageR:** `install.packages("googleCloudStorageR")`


Load the packages.
```{r package-load}

library(neonUtilities)
library(neonMDP)
library(googleCloudStorageR)

```

<a href="/packages-in-r" target="_blank"> More on Packages in R </a>– Adapted from Software Carpentry.


### Working Directory
This lesson will download MDP data to your working directory.

<a href="https://www.neonscience.org/set-working-directory-r" target="_blank"> An overview
of setting the working directory in R can be found here.</a>


## Download Instrument Data from Google Cloud Storage Bucket

First, we will download all Instrument System (IS) data from the GCS bucket. 
IS data includes all automated sensors except for the Surface-Atmosphere 
Exchange data, which will be downloaded in a separate section below.

Change the bucket in the code below to the bucket set up for your MDP data, 
then run this section once to download all existing IS data from the bucket.
Note that the code will error if data have already been downloaded. 
To retrieve new data each month, see the "get new data" section below.

```{r download-is-data}

setGcsEnv(bucket='neon-rss-md04')
downloadMDP('Publication')

```

## Stack IS Data 

NEON data are provided in product-site-month increments. 
The following code will stack (compile) the full time-series of IS products. 
The `stackfromStore` function stacks data downloaded to the local environment, 
which we did earlier.
Examples for three products are provided below. You can see which products are
available by looking in the "Publication" folder of the working directory.

If there are data from more than one site in the working directory, change 
the `site=` parameter in the code snippets below from "all" to the 4-character 
MDP site code (e.g. "MD04") that you want to explore. See the Help page for the `stackFromStore` function for descriptions of other options you may want to change (e.g. the stacked date range).

```{r stack-is-data}

# Single-aspirated Air Temperature
saat <- stackFromStore(dpID='DP1.00002.001', filepaths=getwd(), site='all',
                     startdate=NA, enddate=NA, package='expanded')

# Relative Humidity
rh <- stackFromStore(dpID='DP1.00098.001', filepaths=getwd(), site='all',
                     startdate=NA, enddate=NA, package='basic')

# Water Quality
wq <- stackFromStore(dpID='DP1.20288.001', filepaths=getwd(), site='all',
                     startdate=NA, enddate=NA, package='expanded')

```
The resultant data lists will include data frames containing time-series data
along with other tables containing metadata. 

```{r list-is-data}

# 30-minute single-aspirated air temperature (1st 10 rows)
saat$SAAT_30min[1:10,]

# variable descriptions for the single-aspirated air temperature data
saat$variables_00002

```
## Download Surface-Atmosphere Exchange Data from Google Cloud Storage Bucket

Now we will download all Surface-Atmosphere Exchange (SAE) data from the GCS bucket. 

Change the bucket in the code below to the bucket set up for your MDP data, 
then run this section once to download all existing SAE data from the bucket.
Note that the code will error if data have already been downloaded. 
To retrieve new data each month, see the "get new data" section below.

```{r download-sae-data}

setGcsEnv(bucket='neon-rss-md04')
downloadMDP('ods/dataproducts/DP4')

```

## Stack SAE Data 

The following code will stack (compile) SAE products providing a complete 
time-series for the downloaded MDP site. The `stackFromStore` function utilizes
the `stackEddy` function which is described in great detail in the 
<a href="https://www.neonscience.org/eddy-data-intro" target="_blank">Introduction to working with NEON eddy flux data</a>. 
The MDP data files are in the same format as described in the tutorial.  Below we
show examples of stacking the Level 4 flux data and Level 1 isotopic ratios.

If there are data from more than one site in the working directory, change 
the `site=` parameter in the code snippets below from "all" to the 4-character 
MDP site code (e.g. "MD04") that you want to explore. See the Help page for the `stackFromStore` function for descriptions of other options you may want to change (e.g. the stacked date range).

```{r stack-sae-data}

# NSAE data
flux <- stackFromStore(dpID='DP4.00200.001', filepaths=paste(getwd(), 'ods', sep='/'), 
                       site='all', startdate=NA, enddate=NA, package='basic', level='dp04')

# CO2 isotope data
iso <- stackFromStore(dpID='DP4.00200.001', filepaths=paste(getwd(), 'ods', sep='/'), site='all',
                      startdate=NA, enddate=NA, package='basic', 
                      level='dp01', timeIndex=30, var='dlta13CCo2')

```
The resultant data lists will include the `variables` and `objDesc` tables to 
help you interpret the data by describing term definitions and units for 
variables.

```{r list-sae-data}

# flux data variables
flux$variables

# CO2 isotope data (1st 10 rows)
iso$MD04[1:10,]

```

## Get New Data

To retrieve new data published to the bucket each month, change the bucket in 
the code below to the bucket set up for your MDP data, then run this section.


```{r download-new-data}

setGcsEnv(bucket='neon-rss-md04')
updateMDP('Publication')
updateMDP('ods/dataproducts/DP4')

```

## Explore Data by Accessing other NEON Tutorials 

After stacking the IS data, you can transfer to the 
<a href="https://www.neonscience.org/resources/learning-hub/tutorials/get-started-neon-data-series-data-tutorials#jump-70" target="_blank">Explore Temperature data</a> section in the Get Started with NEON Data series of tutorials. The tutorial guides you through the data and metadata contents of the list output from the `stackFromStore` function for IS products, including how to interpret quality flags as well as do basic plotting and manipulation of data tables. 

There are several SAE related tutorials. The aforementioned 
<a href="https://www.neonscience.org/eddy-data-intro" target="_blank">Introduction to working with NEON eddy flux data</a> is
a great starting point. Another tutorial that may be of interest is the
<a href="https://www.neonscience.org/eddy-diel-cycle" target="_blank"> Exploring diel carbon flux cycles</a>, which provides 
a more comprehensive exploration of the carbon fluxes by looking at diel 
patterns and highlighting how to utilize NEON quality flags to evaluate data 
quality.

## Save Data in .csv Format 
If preferred, IS time-series data compiled with the `stackFromStore` function can easily be written to .csv format. The following example code will write the 30-minute single-aspirated air temperature data to file.

```{r write-is-to-csv}

write.csv(saat$SAAT_30min, file="SAAT_30min_stacked.csv", row.names=F)

```

Writing out the stacked SAE data to .csv is similarly easy. The following example code will write the 30-minute CO<sub>2</sub> isotope data to file. Change the "MD04" site code in `iso$MD04` in the code below to the 4-character site code for your MDP. 

```{r write-sae-to-csv}

write.csv(iso$MD04, file="co2_isotopes_30min_stacked.csv", row.names=F)

```

